const K=Symbol(),I=Object.getPrototypeOf,B=new WeakMap,X=t=>t&&(B.has(t)?B.get(t):I(t)===Object.prototype||I(t)===Array.prototype),$=t=>X(t)&&t[K]||null,z=(t,a=!0)=>{B.set(t,a)},W=t=>typeof t=="object"&&t!==null,v=new WeakMap,U=new WeakSet,q=(t=Object.is,a=(o,c)=>new Proxy(o,c),S=o=>W(o)&&!U.has(o)&&(Array.isArray(o)||!(Symbol.iterator in o))&&!(o instanceof WeakMap)&&!(o instanceof WeakSet)&&!(o instanceof Error)&&!(o instanceof Number)&&!(o instanceof Date)&&!(o instanceof String)&&!(o instanceof RegExp)&&!(o instanceof ArrayBuffer),y=o=>{switch(o.status){case"fulfilled":return o.value;case"rejected":throw o.reason;default:throw o}},d=new WeakMap,O=(o,c,r=y)=>{const E=d.get(o);if((E==null?void 0:E[0])===c)return E[1];const i=Array.isArray(o)?[]:Object.create(Object.getPrototypeOf(o));return z(i,!0),d.set(o,[c,i]),Reflect.ownKeys(o).forEach(l=>{if(Object.getOwnPropertyDescriptor(i,l))return;const D=Reflect.get(o,l),w={value:D,enumerable:!0};U.has(D)?z(D,!1):D instanceof Promise?(delete w.value,w.get=()=>r(D)):v.has(D)&&(w.value=A(D,r)),Object.defineProperty(i,l,w)}),i},p=new WeakMap,h=[1,1],_=function o(c){if(!W(c))throw new Error("object required");const r=p.get(c);if(r)return r;let E=h[0];const i=new Set,l=(s,n=++h[0])=>{E!==n&&(E=n,i.forEach(e=>e(s,n)))};let D=h[1];const w=(s=++h[1])=>(D!==s&&!i.size&&(D=s,f.forEach(([n])=>{const e=n[1](s);e>E&&(E=e)})),E),L=s=>(n,e)=>{const u=[...n];u[1]=[s,...u[1]],l(u,e)},f=new Map,N=(s,n)=>{var e;if(((e={BASE_URL:"/matrix/",MODE:"production",DEV:!1,PROD:!0})==null?void 0:e.MODE)!=="production"&&f.has(s))throw new Error("prop listener already exists");if(i.size){const u=n[3](L(s));f.set(s,[n,u])}else f.set(s,[n])},V=s=>{var n;const e=f.get(s);e&&(f.delete(s),(n=e[1])==null||n.call(e))},m=s=>(i.add(s),i.size===1&&f.forEach(([e,u],M)=>{var R;if(((R={BASE_URL:"/matrix/",MODE:"production",DEV:!1,PROD:!0})==null?void 0:R.MODE)!=="production"&&u)throw new Error("remove already exists");const b=e[3](L(M));f.set(M,[e,b])}),()=>{i.delete(s),i.size===0&&f.forEach(([e,u],M)=>{u&&(u(),f.set(M,[e]))})}),T=Array.isArray(c)?[]:Object.create(Object.getPrototypeOf(c)),g=a(T,{deleteProperty(s,n){const e=Reflect.get(s,n);V(n);const u=Reflect.deleteProperty(s,n);return u&&l(["delete",[n],e]),u},set(s,n,e,u){const M=Reflect.has(s,n),R=Reflect.get(s,n,u);if(M&&(t(R,e)||p.has(e)&&t(R,p.get(e))))return!0;V(n),W(e)&&(e=$(e)||e);let b=e;if(e instanceof Promise)e.then(P=>{e.status="fulfilled",e.value=P,l(["resolve",[n],P])}).catch(P=>{e.status="rejected",e.reason=P,l(["reject",[n],P])});else{!v.has(e)&&S(e)&&(b=o(e));const P=!U.has(b)&&v.get(b);P&&N(n,P)}return Reflect.set(s,n,b,u),l(["set",[n],e,R]),!0}});p.set(c,g);const F=[T,w,O,m];return v.set(g,F),Reflect.ownKeys(c).forEach(s=>{const n=Object.getOwnPropertyDescriptor(c,s),e="value"in n;delete n.value,Object.defineProperty(T,s,n),e&&(g[s]=c[s])}),g})=>[_,v,U,t,a,S,y,d,O,p,h],[G]=q();function Y(t={}){return G(t)}function J(t,a,S){var y;const d=v.get(t);((y={BASE_URL:"/matrix/",MODE:"production",DEV:!1,PROD:!0})==null?void 0:y.MODE)!=="production"&&!d&&console.warn("Please use proxy object");let O;const p=[],h=d[3];let _=!1;const c=h(r=>{if(p.push(r),S){a(p.splice(0));return}O||(O=Promise.resolve().then(()=>{O=void 0,_&&a(p.splice(0))}))});return _=!0,()=>{_=!1,c()}}function A(t,a){var S;const y=v.get(t);((S={BASE_URL:"/matrix/",MODE:"production",DEV:!1,PROD:!0})==null?void 0:S.MODE)!=="production"&&!y&&console.warn("Please use proxy object");const[d,O,p]=y;return p(d,O(),a)}function Z(t,a,S,y){let d=t[a];return J(t,()=>{const O=t[a];Object.is(d,O)||S(d=O)},y)}const j=Symbol();function k(t,a){var S,y;typeof a=="string"&&(console.warn("string name option is deprecated, use { name }. https://github.com/pmndrs/valtio/pull/400"),a={name:a});const{enabled:d,name:O=""}=a||{};let p;try{p=(d!=null?d:((S={BASE_URL:"/matrix/",MODE:"production",DEV:!1,PROD:!0})==null?void 0:S.MODE)!=="production")&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!p){((y={BASE_URL:"/matrix/",MODE:"production",DEV:!1,PROD:!0})==null?void 0:y.MODE)!=="production"&&d&&console.warn("[Warning] Please install/enable Redux devtools extension");return}let h=!1;const _=p.connect({name:O}),o=J(t,r=>{const E=r.filter(([i,l])=>l[0]!==j).map(([i,l])=>`${i}:${l.map(String).join(".")}`).join(", ");if(!!E)if(h)h=!1;else{const i=Object.assign({},A(t));delete i[j],_.send({type:E,updatedAt:new Date().toLocaleString()},i)}}),c=_.subscribe(r=>{var E,i,l,D,w,L;if(r.type==="ACTION"&&r.payload)try{Object.assign(t,JSON.parse(r.payload))}catch(f){console.error(`please dispatch a serializable value that JSON.parse() and proxy() support
`,f)}if(r.type==="DISPATCH"&&r.state){if(((E=r.payload)==null?void 0:E.type)==="JUMP_TO_ACTION"||((i=r.payload)==null?void 0:i.type)==="JUMP_TO_STATE"){h=!0;const f=JSON.parse(r.state);Object.assign(t,f)}t[j]=r}else if(r.type==="DISPATCH"&&((l=r.payload)==null?void 0:l.type)==="COMMIT")_.init(A(t));else if(r.type==="DISPATCH"&&((D=r.payload)==null?void 0:D.type)==="IMPORT_STATE"){const f=(w=r.payload.nextLiftedState)==null?void 0:w.actionsById,N=((L=r.payload.nextLiftedState)==null?void 0:L.computedStates)||[];h=!0,N.forEach(({state:V},m)=>{const T=f[m]||"No action found";Object.assign(t,V),m===0?_.init(A(t)):_.send(T,A(t))})}});return _.init(A(t)),()=>{o(),c==null||c()}}export{k as d,Y as p,Z as s};
